<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<HTML>
<HEAD>
</HEAD>
<BODY>

<script type="text/javascript" src="lib/js/jquery-1.7.js"></script>

<script type="text/javascript" src="js/charts/HelperFunctions.js"></script>

<script type="text/javascript" src="js/Debug.js"></script>
<script type="text/javascript" src="js/rest/ElasticSearchQuery.js"></script>
<script type="text/javascript" src="js/util.js"></script>
<script type="text/javascript" src="js/CNV.js"></script>
<script type="text/javascript" src="js/aDate.js"></script>
<script type="text/javascript" src="js/MVEL.js"></script>
<script type="text/javascript" src="js/aCompiler.js"></script>

<script type="text/javascript" src="js/CUBE.js"></script>



<div id="info"></div>

<script type="text/javascript">
	D.println(new Date(1352207434236).format("yyyy-NNN-dd HHmmss"));

	var  esQuery = {
  "query": {
    "filtered": {
      "query": {
        "match_all": {}
      },
      "filter": {
		  "and":[
			  {"range":{"bug_id":{"gt":800000}}},
			  {"term":{"qa_contact":"general@fennec.bugs"}}
		  ]
//		  "script":{"script":'_source.toString().indexOf("fennec")>0'}
//		"and":[
//			{"range": {"expires_on": {"gt": 1352207434236 }}},
//			{"not":{"terms" : {"bug_status" : ["resolved", "verified", "closed"]}}},
//			"or": [
//			{"prefix": {"cf_tracking_fennec": "+" } },
//			{"prefix": { "cf_tracking_fennec": "?" } }
//			]
//		]
      }
    }
  },
  "from": 0,
  "size": 10000,
  "sort": [],
//		"facets":{
//
//			"Fennec": {
//      "terms": {
//        "script_field": "\"Fennec\"",
//        "size": 10000
//      },
//      "facet_filter": {
//        "or": [
//          {
//            "prefix": {
//              "cf_blocking_fennec10": "+"
//            }
//          },
//          {
//            "prefix": {
//              "cf_blocking_fennec10": "?"
//            }
//          }
//        ]
//      }
//    }
//		}
}
;


	ElasticSearchQuery.Run({
		"query":esQuery,

		success: function(data){
			D.println(CNV.Object2JSON(data));

			var htmlSummary = CNV.ESResult2HTMLSummaries(data);
			var htmlResults = CNV.List2HTMLTable(CNV.ESResult2List(data));

			document.getElementById("info").innerHTML = htmlSummary + "<br><br>" + htmlResults;
		},

		error: function (errorData, errorMsg, errorThrown){
			document.getElementById("info").innerHTML = "Response Error.  Make sure you are connected to the MPT network.";
		}
	});

</script>

</BODY>
</HTML>