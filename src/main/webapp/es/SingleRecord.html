<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<HTML>
<HEAD>
</HEAD>
<BODY>

<script type="text/javascript" src="lib/js/jquery-1.7.js"></script>

<script type="text/javascript" src="js/charts/HelperFunctions.js"></script>

<script type="text/javascript" src="js/Debug.js"></script>
<script type="text/javascript" src="js/rest/ElasticSearchQuery.js"></script>
<script type="text/javascript" src="js/util.js"></script>
<script type="text/javascript" src="js/CNV.js"></script>
<script type="text/javascript" src="js/aDate.js"></script>
<script type="text/javascript" src="js/MVEL.js"></script>
<script type="text/javascript" src="js/aCompiler.js"></script>

<script type="text/javascript" src="js/CUBE.js"></script>



<div id="info"></div>

<script type="text/javascript">
	D.println(new Date(1347753600000).format("yyyy-NNN-dd HHmmss"));
	D.println(new Date(1348358400000).format("yyyy-NNN-dd HHmmss"));

	var  esQuery = {
  "query": {
    "filtered": {
      "query": {
        "match_all": {}
      },
      "filter": {
        "and": [
          {
            "script": {
              "script": "true"
            }
          }
        ]
      }
    }
  },
  "from": 0,
  "size": 10,
  "sort": [],
  "facets": {
    "0": {
      "statistical": {
        "script": "var replaceAll = function(output, find, replace){\ns = output.indexOf(find, 0);\nwhile(s>=0){\noutput=output.replace(find, replace);\ns=s-find.length+replace.length;\ns = output.indexOf(find, s);\n}\noutput;\n};\nvar Value2Pipe = function(value){\nif (value==null){ \"0\" }else if (!(value is String)){ 'n'+value; }else{\n\"s\"+replaceAll(replaceAll(value, \"\\\\\", \"\\\\\\\\\"), \"|\", \"\\\\p\");}};\nvar floorDay = function(value){ Math.floor(value/(24*60*60*1000))*(24*60*60*1000);};\nvar cool_func = function(bugs){\noutput=\"\";\nif (true){output = Value2Pipe(bugs.bug_id)\n;\n}\noutput;\n};\ncool_func(_source)\n"
      }
    }
  }
}
;


	ElasticSearchQuery.Run({
		"query":esQuery,

		success: function(data){
			D.println(CNV.Object2JSON(data));

			var htmlSummary = CNV.ESResult2HTMLSummaries(data);
			var htmlResults = CNV.List2HTMLTable(CNV.ESResult2List(data));

			document.getElementById("info").innerHTML = htmlSummary + "<br><br>" + htmlResults;
		},

		error: function (errorData, errorMsg, errorThrown){
			document.getElementById("info").innerHTML = "Response Error.  Make sure you are connected to the MPT network.";
		}
	});

</script>

</BODY>
</HTML>